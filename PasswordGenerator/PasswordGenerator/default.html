<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Password Generator">
    <meta name="author" content="Ruslan Galiev">
    <link rel="shortcut icon" href="favicon.ico">
    <title>Password Generator</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-theme.min.css" rel="stylesheet">
    <style>
        .jumbotron p {
          margin-bottom: 5px;
          font-size: 21px;
          font-weight: 200;
        }
    </style>
</head>
<body role="document" >
    <div class="navbar navbar navbar-static-top" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Password Generator</a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="#">Home</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#contact">Contact</a></li>
                    <!--<li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Action</a></li>
                            <li><a href="#">Another action</a></li>
                            <li><a href="#">Something else here</a></li>
                            <li class="divider"></li>
                            <li class="dropdown-header">Nav header</li>
                            <li><a href="#">Separated link</a></li>
                            <li><a href="#">One more separated link</a></li>
                        </ul>
                    </li>-->
                </ul>
            </div>
        </div>
    </div>
    <div class="container theme-showcase" role="main">
        <h2>Generated passwords</h2>
        <div class="jumbotron" style="background-image: url(images/lock.png); background-position: 350px center; background-repeat: no-repeat;">
            <div id="outputs">
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
                <p>&nbsp;</p>
            </div>
        </div>
        <h2>Options</h2>
        <div id="options">
            <p>
                <span>Create a random pass phrase consisting of short words</span><br />
                <div class="checkbox">
                    <input checked="checked" type="checkbox" id="chNumbers" value="1" />
                    <span>Include Numbers</span>
                </div>
                <div class="checkbox">
                    <input checked="checked" type="checkbox" id="chSymbols" value="1" />
                    <span>Include Symbols</span>
                </div>
                <div class="checkbox">
                    <span>Minimum Password Lenght</span>
                    <input id="txtMinLength" value="10" style="width: 30px; height: 25px;" />
                    <span>characters</span>
                </div>
                <div class="checkbox">
                    <input checked="checked" type="checkbox" id="chCapital" value="1" />
                    <span>Randomly Capitalize Letters</span>
                </div>
            </p>
            <p>
                <button onclick="generate();" type="button" class="btn btn-lg btn-primary">Generate</button>
            </p>
        </div>
    </div>
    <script src="Scripts/jquery-2.1.1.min.js"></script>
    <script>
        "use strict";
        function randomString(length, chars) {
            var mask = '';
            if (chars.indexOf('a') > -1) mask += 'abcdefghijklmnopqrstuvwxyz';
            if (chars.indexOf('A') > -1) mask += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (chars.indexOf('#') > -1) mask += '0123456789';
            if (chars.indexOf('!') > -1) mask += '~!@#$%^&*()_+-={}:;';
            var result = '';
            for (var i = length; i > 0; --i) result += mask[Math.round(Math.random() * (mask.length - 1))];
            return result;
        }
        function output(pass) {
            var outputs = $("#outputs");
            var newLine = $("<p>");
            newLine.html(pass);
            newLine.addClass("pass");
            outputs.append(newLine);
        }
        function randomWord(dic, isRandCapital) {
            var w = dic[Math.round(Math.random() * (dic.length - 1))];
            w = w.toLowerCase();
            if (isRandCapital) {
                var nw = "";
                for (var i = 0; i < w.length; i++) {
                    if (randomBool(0.2)) {
                        nw += w[i].toUpperCase();
                    } else {
                        nw += w[i].toLowerCase();
                    }
                }
                w = nw;
            }
            return w;
        }
        function randomNumber() {
            return Math.round(Math.random() * 100);
        }
        function randomSymbol() {
            return randomString(1, "!");
        }
        function randomBool(probabilityTrue) {
            if (!isFinite(probabilityTrue)) {
                probabilityTrue = 0.5;
            }
            return Math.random() < probabilityTrue;
        }
        function gen2(dic, len, isIncludeNumbers, isIncludeSymbols, isRadnomCapitalize) {
            var pass = '';
            var odd = 0;
            var wasNumber = false;
            var wasSymbol = false;
            while (pass.length < len) {
                odd++;
                if (odd % 2 == 1) {
                    pass += randomWord(dic, isRadnomCapitalize);
                } else {
                    if (randomBool() && isIncludeSymbols) {
                        pass += randomSymbol();
                        wasSymbol = true;
                    } else if (isIncludeNumbers) {
                        pass += randomNumber();
                        wasNumber = true;
                    }
                }
            }
            if (!wasNumber && isIncludeNumbers) {
                pass += randomNumber();
            }
            if (!wasSymbol && isIncludeSymbols) {
                pass += randomSymbol();
            }
            return pass;
        }
        function generate() {
            var outputs = $("#outputs");
            outputs.html("");

            if (__global_words_1C812844 == null) {
                __global_words_1C812844 = downloadWords();
            }

            var len = parseInt($("#txtMinLength").val());
            {
                // validate length
                if (!isFinite(len)) {
                    len = 10;
                }
                if (len > 20) {
                    len = 20;
                }
                if (len < 6) {
                    len = 6;
                }
                $("#txtMinLength").val(len);
            }
            var isIncludeNumbers = $("#chNumbers").is(":checked");
            var isIncludeSymbols = $("#chSymbols").is(":checked");
            var isRandomCapitalize = $("#chCapital").is(":checked");

            var count = 10;
            while (count-- > 0) {
                output(gen2(__global_words_1C812844, len, isIncludeNumbers, isIncludeSymbols, isRandomCapitalize));
            }
        }
        function downloadWords() {
            var x = new XMLHttpRequest();
            x.open("GET", "w.txt", false);
            x.send();
            var words = x.responseText.split("\r\n");
            return words;
        }
        var __global_words_1C812844 = downloadWords();
        generate();
    </script>
    <script src="js/jquery-2.1.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
</body>
</html>
